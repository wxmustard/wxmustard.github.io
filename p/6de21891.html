<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="Mr Wang's blog"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>SpringBoot——数据库 - Mr Wang's blog</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="//s3.shu.aixinwu.org/wx_post_bg.jpg"><div class="post-title"><h1 class="title">SpringBoot——数据库</h1><ul class="meta"><li><i class="icon icon-author"></i>Mustard Wang</li><li><i class="icon icon-clock"></i>9 Minutes</li><li><i class="icon icon-calendar"></i>2017年11月1日</li></ul></div></div><div class="article-content" style="max-width:800px"><ul>
<li><p><code>Spring-Data-Jpa</code> ：<code>Spring</code> 与<code>Hibernate</code>的组合</p>
<p><code>JPA</code>:定义了一系列对象持久化的标准，目前实现这一规范的产品有<code>Hibernate</code>和<code>Toplink</code>等</p>
</li>
<li><p>实例：</p>
<ul>
<li><p>添加数据库依赖</p>
<ul>
<li><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>？在pom.xml中添加依赖时不自动提示</p>
<p>解决方法：setting –&gt; Build,execution,deployment –&gt; Build tools –&gt;Maven –&gt; Repositories –&gt; update</p>
</li>
<li><p>?  pom.xml中添加的依赖勾红线</p>
<p>解决方法： 更换<code>Maven</code>的镜像源，打开</p>
<p><img src="https://vgy.me/ihYmy4.png" alt=""></p>
<p>查看User setting file 的地址，大多数情况下此地址下是没有<code>settings.xml</code>文件的，需要新建，在文件中添加阿里云的镜像源 <strong>override的复选框一定要打钩</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/SETTINGS/1.0.0"</span></span></div><div class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></div><div class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/SETTINGS/1.0.0</span></span></div><div class="line"><span class="tag"><span class="string">                          https://maven.apache.org/xsd/settings-1.0.0.xsd"</span>&gt;</span></div><div class="line"></div><div class="line">      <span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>          </div><div class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></div></pre></td></tr></table></figure>
<p>回到<code>IDEA</code>，刷新<code>pom.xml</code>即可</p>
</li>
</ul>
</li>
<li><p>设置<code>application.yml</code>中的数据库信息</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="attr">spring:</span></div><div class="line"><span class="attr">  profiles:</span></div><div class="line"><span class="attr">    active:</span> <span class="string">dev</span></div><div class="line"></div><div class="line"><span class="attr">  datasource:</span></div><div class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></div><div class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://172.28.0.1:3306/wx?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span></div><div class="line"><span class="attr">    username:</span> <span class="string">root</span></div><div class="line"><span class="attr">    password:</span> <span class="string">root</span></div><div class="line"><span class="attr">  jpa:</span></div><div class="line"><span class="attr">    hibernate:</span></div><div class="line"><span class="attr">      ddl-auto:</span> <span class="string">create</span></div><div class="line"><span class="attr">    show-sql:</span> <span class="literal">true</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>ddl-auto</code>类型区分：</p>
<p>|     类型      |                  作用                  |<br>| :———: | :———————————-: |<br>|   create    | 每一次运行时都创建一个新的表，如果之前有同名的表，删掉同名的在创建新的表 |<br>|   update    |   第一次运行时也会创建相对应的表结构，但是不会删除其中已存在的数据   |<br>|  validate   |     验证数据库里的表结构和类中的属性是否一致，不一致将会报错     |<br>| create-drop |            应用停下来的时候，将表删除             |</p>
</li>
<li><p>添加一个对应数据库中表的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.wx.girl;</div></pre></td></tr></table></figure>
<p>import javax.persistence.Entity;<br>import javax.persistence.GeneratedValue;<br>import javax.persistence.Id;</p>
<p>/**</p>
<ul>
<li>Created by mustard</li>
<li><p>17-11-1 上午9:43<br>*/<br>@Entity  //与数据库对应的注解<br>public class Girl {</p>
<p> @Id<br> @GeneratedValue   //添加自增的Id字段<br> private Integer id;</p>
<p> public Integer getId() {</p>
<pre><code>return id;
</code></pre><p> }</p>
<p> public String getName() {</p>
<pre><code>return name;
</code></pre><p> }</p>
<p> public Integer getAge() {</p>
<pre><code>return age;
</code></pre><p> }</p>
<p> private String name;</p>
<p> private Integer age;<br> //使用无参构造函数<br> public Girl() {<br> }<br>}<br>​```</p>
</li>
</ul>
<ul>
<li><p>运行时出现错误提醒：WARN: Establishing SSL connection without server’s identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn’t set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to ‘false’. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.</p>
<p>解决方法：在数据库连接的库名后添加<code>?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</code></p>
</li>
</ul>
</li>
<li><p><img src="https://vgy.me/bbfsC0.png" alt=""></p>
</li>
</ul>
</li>
</ul>
</div><div class="article-meta" style="max-width:800px"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/">IDEA</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a><span class="tag-list-count">5</span></li></ul></div><div class="categories"><i class="icon icon-category"></i><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">24</span></li></ul></div></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/p/a467a3ad.html"><i class="icon icon-arror-left"></i></a></li><li><a href="/p/a707a952.html"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/" title="Github" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2017 Mr Wang's blog<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>