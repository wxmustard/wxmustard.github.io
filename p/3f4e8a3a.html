<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="Mr Wang's blog"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>nginx 安装实验 - Mr Wang's blog</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="//s3.shu.aixinwu.org/wx_post_bg.jpg"><div class="post-title"><h1 class="title">nginx 安装实验</h1><ul class="meta"><li><i class="icon icon-author"></i>Mustard Wang</li><li><i class="icon icon-clock"></i>12 Minutes</li><li><i class="icon icon-calendar"></i>2017年10月11日</li></ul></div></div><div class="article-content" style="max-width:800px"><h1 id="nginx-安装实验-ubuntu"><a href="#nginx-安装实验-ubuntu" class="headerlink" title="nginx 安装实验(ubuntu)"></a>nginx 安装实验(ubuntu)</h1><ul>
<li><p>安装依赖包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libpcre3 libpcre3-dev zlib1g-dev libssl-dev build-essential</div></pre></td></tr></table></figure>
</li>
<li><p>安装编译源码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">sudo apt install wget vim links</div><div class="line"><span class="meta">#</span><span class="bash"> wget:下载源码,vim:编辑文件,links:测试访问</span></div><div class="line">wget http://nginx.org/download/nginx-1.12.1.tar.gz</div><div class="line"><span class="meta">#</span><span class="bash"> 下载安装包</span></div><div class="line">tar xzf nginx-1.12.1.tar.gz </div><div class="line"><span class="meta">#</span><span class="bash"> 解压安装包</span></div><div class="line">sudo useradd www -s /sbin/nologin</div><div class="line"><span class="meta">#</span><span class="bash"> 添加用户www,并指定用户无法登录</span></div><div class="line">cd nginx-1.12.1/</div><div class="line"><span class="meta">#</span><span class="bash"> 进入文件夹</span></div><div class="line">./configure --user=www --group=www --prefix=/usr/local/nginx/ --with-http_stub_status_module --with-http_ssl_module</div><div class="line"><span class="meta">#</span><span class="bash"> 修改配置文件</span></div><div class="line">make &amp;&amp; make install</div><div class="line"><span class="meta">#</span><span class="bash"> 编译程序</span></div></pre></td></tr></table></figure>
</li>
<li><p>测试<code>nginx</code>是否安装成功</p>
<p>-<strong>方法一: </strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> 查看nginx版本信息</span></div><div class="line">/usr/local/nginx/sbin/nginx -V</div></pre></td></tr></table></figure>
<p><img src="https://vgy.me/3Im1GG.png" alt=""></p>
<p><strong>方法二: </strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> 执行启动命令</span></div><div class="line">/usr/local/nginx/sbin/nginx -c usr/local/nginx/conf/nginx.conf</div><div class="line">检测80端口</div><div class="line">netstat -an | grep 80</div></pre></td></tr></table></figure>
<p><img src="https://vgy.me/OZePyK.png" alt=""></p>
<p><strong>方法三:</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">links http://vm15</div></pre></td></tr></table></figure>
<p><img src="https://vgy.me/8JCybT.png" alt=""></p>
</li>
<li><p>自定义<code>nginx</code>的<code>service</code>服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /etc/init.d</div><div class="line">vim nginx </div><div class="line"><span class="meta">#</span><span class="bash"> 创建并修改nginx的services服务文件</span></div></pre></td></tr></table></figure>
<p><code>nginx</code>文件内容如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- nginx --&gt;</span></div><div class="line">#! /bin/sh</div><div class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</div><div class="line">NAME=nginx</div><div class="line">NGINX_BIN=/usr/local/nginx/sbin/$NAME</div><div class="line">CONFIGFILE=/usr/local/nginx/conf/$NAME.conf</div><div class="line">PIDFILE=/usr/local/nginx/logs/$NAME.pid</div><div class="line">case "$1" in</div><div class="line">    start)</div><div class="line">        echo -n "Starting $NAME... "</div><div class="line">        if netstat -tnpl | grep -q nginx;then</div><div class="line">            echo "$NAME (pid `pidof $NAME`) already running."</div><div class="line">            exit 1</div><div class="line">        fi</div><div class="line">        $NGINX_BIN -c $CONFIGFILE</div><div class="line">        if [ "$?" != 0 ] ; then</div><div class="line">            echo " failed"</div><div class="line">            exit 1</div><div class="line">        else</div><div class="line">            echo " done"</div><div class="line">        fi</div><div class="line">        ;;</div><div class="line">    stop)</div><div class="line">        echo -n "Stoping $NAME... "</div><div class="line">if ! netstat -tnpl | grep -q nginx; then</div><div class="line">            echo "$NAME is not running."</div><div class="line">            exit 1</div><div class="line">        fi</div><div class="line">        $NGINX_BIN -s stop</div><div class="line">        if [ "$?" != 0 ] ; then</div><div class="line">            echo " failed. Use force-quit"</div><div class="line">            exit 1</div><div class="line">        else</div><div class="line">            echo " done"</div><div class="line">        fi</div><div class="line">        ;;</div><div class="line">    status)</div><div class="line">        if netstat -tnpl | grep -q nginx; then</div><div class="line">            PID=`pidof nginx`</div><div class="line">            echo "$NAME (pid $PID) is running..."</div><div class="line">        else</div><div class="line">            echo "$NAME is stopped"</div><div class="line">            exit 0</div><div class="line">        fi</div><div class="line">        ;;</div><div class="line">    force-quit)</div><div class="line">        echo -n "Terminating $NAME... "</div><div class="line">        if ! netstat -tnpl | grep -q nginx; then</div><div class="line">            echo "$NAME is not running."</div><div class="line">            exit 1</div><div class="line">        fi</div><div class="line">        kill `pidof $NAME`</div><div class="line">        if [ "$?" != 0 ] ; then</div><div class="line">            echo " failed"</div><div class="line">            exit 1</div><div class="line">        else</div><div class="line">            echo " done"</div><div class="line">        fi</div><div class="line">        ;;</div><div class="line">    restart)</div><div class="line">        $0 stop</div><div class="line">        sleep 1</div><div class="line">        $0 start</div><div class="line">        ;;</div><div class="line">    reload)</div><div class="line">        echo -n "Reload service $NAME... "</div><div class="line">        if netstat -tnpl | grep -q nginx; then</div><div class="line">            $NGINX_BIN -s reload</div><div class="line">echo " done"</div><div class="line">        else</div><div class="line">            echo "$NAME is not running, can't reload."</div><div class="line">            exit 1</div><div class="line">        fi</div><div class="line">        ;;</div><div class="line">    configtest)</div><div class="line">        echo -n "Test $NAME configure files... "</div><div class="line">        $NGINX_BIN -t</div><div class="line">        ;;</div><div class="line">    *)</div><div class="line">        echo "Usage: $0 &#123;start|stop|force-quit|restart|reload|status|configtest&#125;"</div><div class="line">        exit 1</div><div class="line">        ;;</div><div class="line">esac</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> 修改脚本文件nginx的权限</span></div><div class="line">sudo chmod 755 nginx</div><div class="line"><span class="meta">#</span><span class="bash"> 修改开机自启动文件</span></div><div class="line">sudo vim /etc/rc.local</div><div class="line"><span class="meta">#</span><span class="bash"> 将下面的代码添加到rc.local文件的<span class="built_in">exit</span> 0 之前</span></div><div class="line">sudo service nginx start</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</div><div class="article-meta" style="max-width:800px"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a><span class="tag-list-count">6</span></li></ul></div><div class="categories"><i class="icon icon-category"></i><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">24</span></li></ul></div></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/p/10ed7470.html"><i class="icon icon-arror-left"></i></a></li><li><a href="/p/4b40aed8.html"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/" title="Github" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2017 Mr Wang's blog<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>